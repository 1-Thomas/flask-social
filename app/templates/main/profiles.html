{% extends "base.html" %}
{% block title %}{{ profile_user.username }}{% endblock %}
{% block content %}
  <h1>@{{ profile_user.username }}</h1>

  {% if profile_user.bio %}
    <p>{{ profile_user.bio }}</p>
  {% else %}
    <p><em>No bio yet.</em></p>
  {% endif %}

  <p><small>Joined: {{ profile_user.created_at.strftime('%Y-%m-%d') }}</small></p>

  {% if current_user.is_authenticated and current_user.id != profile_user.id %}
    <form method="post"
          action="{{ url_for('main.follow', username=profile_user.username) }}"
          style="display:inline;">
      {{ csrf_token() }}
      {% if current_user.is_following(profile_user) %}
        </form>
        <form method="post"
              action="{{ url_for('main.unfollow', username=profile_user.username) }}"
              style="display:inline;">
          {{ csrf_token() }}
          <button type="submit">Unfollow</button>
        </form>
      {% else %}
        <button type="submit">Follow</button>
    </form>
      {% endif %}
  {% endif %}


  <hr>

  <h2>Posts</h2>
  {% if posts %}
    {% for post in posts %}
      <div style="margin-bottom: 16px;">
        <small>{{ post.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
        <div style="white-space: pre-wrap;">{{ post.body }}</div>
      </div>
    {% endfor %}
  {% else %}
    <p>No posts yet.</p>
  {% endif %}
{% endblock %}
